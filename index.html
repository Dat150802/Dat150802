<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>KLC Bến Lức</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <link href="./assets/css/custom.css" rel="stylesheet"/>

  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <div class="header-bar">
    <div class="d-flex align-items-center">
      <div class="brand">KLC Bến Lức</div>
      <div class="ms-auto small" id="meBox"></div>
    </div>
  </div>

  <div class="container py-3">

    <!-- Signed out -->
    <div id="signedOut" class="text-center py-5">
      <h4 class="mb-3">Đăng nhập Google để tiếp tục</h4>
      <div id="gbtnWrap" class="d-inline-block"></div>
      <div class="small text-danger mt-2" id="debug"></div>
      <p class="text-muted mt-3">Chỉ tài khoản được cấp trong sheet <code>users</code> mới truy cập.</p>
    </div>

    <!-- App -->
    <div id="app" class="hidden">

      <!-- Menu -->
      <ul class="nav nav-pills mb-3" id="menu">
        <li class="nav-item"><a class="nav-link active" data-section="dashboard" href="#">Trang chủ</a></li>
        <li class="nav-item"><a class="nav-link" data-section="customers" href="#">Khách hàng</a></li>
        <li class="nav-item"><a class="nav-link" data-section="cskh" href="#">CSKH</a></li>
        <li class="nav-item"><a class="nav-link" data-section="warranty" href="#">Bảo hành & BD</a></li>
        <li class="nav-item"><a class="nav-link" data-section="inventory" href="#">Tồn kho</a></li>
        <li class="nav-item"><a class="nav-link" data-section="finance" href="#">Thu & Chi</a></li>
        <li class="nav-item"><a class="nav-link d-none" id="adminTab" data-section="admin" href="#">Quản trị</a></li>
      </ul>

      <!-- DASHBOARD -->
      <section id="section-dashboard">
        <div class="card p-3 mb-3">
          <div class="row g-2 align-items-end">
            <div class="col-6 col-md-2">
              <label class="form-label">Tháng</label>
              <input id="dashMonth" type="number" min="1" max="12" class="form-control">
            </div>
            <div class="col-6 col-md-2">
              <label class="form-label">Năm</label>
              <input id="dashYear" type="number" min="2000" max="2099" class="form-control">
            </div>
            <div class="col-12 col-md-4">
              <label class="form-label">Khoảng ngày (ưu tiên)</label>
              <div class="d-flex gap-2">
                <input id="dashFrom" class="form-control" placeholder="dd/MM/yyyy">
                <input id="dashTo" class="form-control" placeholder="dd/MM/yyyy">
              </div>
            </div>
            <div class="col-12 col-md-4">
              <label class="form-label d-block">&nbsp;</label>
              <button id="dashBtn" class="btn btn-klc">Xem</button>
            </div>
          </div>
        </div>
        <div id="dashMeta" class="small mb-2"></div>
        <div id="dashCards" class="row g-3"></div>
        <pre id="dashRaw" class="mt-3 small text-muted"></pre>
      </section>

      <!-- CUSTOMERS (placeholder layout, logic in app.js uses current backend) -->
      <section id="section-customers" class="hidden">
        <div class="grid-2">
          <div class="card p-3">
            <h5 class="mb-2">Thông tin khách hàng</h5>
            <div class="row g-2">
              <div class="col-md-6"><input id="c_ten" class="form-control" placeholder="Tên"></div>
              <div class="col-md-6"><input id="c_phone" class="form-control" placeholder="Số điện thoại"></div>
              <div class="col-md-6"><input id="c_ngay" class="form-control" placeholder="dd/MM/yyyy"></div>
              <div class="col-md-6"><input id="c_diachi" class="form-control" placeholder="Địa chỉ"></div>
            </div>
            <div class="row g-2 mt-2">
              <div class="col-md-6"><input id="c_model" class="form-control" placeholder="Mẫu ghế (VD: KY02)"></div>
              <div class="col-md-3"><input id="c_gia" type="number" class="form-control" placeholder="Giá bán"></div>
              <div class="col-md-3"><input id="c_bhn" type="number" class="form-control" placeholder="BH (năm)"></div>
            </div>
            <div class="row g-2 mt-2">
              <div class="col-md-6">
                <select id="c_nguon" class="form-select">
                  <option value="Quảng cáo Page">Quảng cáo Page</option>
                  <option value="Tiktok">Tiktok</option>
                  <option value="Hotline">Hotline</option>
                  <option value="Khách ghé ngang cửa hàng">Khách ghé ngang cửa hàng</option>
                  <option value="Người quen giới thiệu">Người quen giới thiệu</option>
                  <option value="Khách cũ mua lại">Khách cũ mua lại</option>
                  <option value="Người quen nhân viên">Người quen nhân viên</option>
                  <option value="Khác">Khác</option>
                </select>
              </div>
              <div class="col-md-6">
                <select id="c_status" class="form-select">
                  <option>Chưa mua</option>
                  <option>Đã mua</option>
                </select>
              </div>
            </div>
            <input id="c_note" class="form-control mt-2" placeholder="Ghi chú">
            <div class="d-flex gap-2 mt-3">
              <button class="btn btn-klc" id="btnSaveCustomer">Lưu</button>
              <button class="btn btn-outline-secondary" id="btnClearCustomer">Xoá form</button>
            </div>
          </div>
          <div class="card p-3">
            <h5 class="mb-2">Danh sách khách hàng</h5>
            <div class="row g-2 align-items-end">
              <div class="col-6"><input id="cl_month" type="number" min="1" max="12" class="form-control" placeholder="Tháng"></div>
              <div class="col-6"><input id="cl_year" type="number" min="2000" max="2099" class="form-control" placeholder="Năm"></div>
              <div class="col-12"><button class="btn btn-klc" id="btnLoadCustomers">Tìm kiếm</button></div>
            </div>
            <input id="c_search" class="form-control mt-2" placeholder="Tìm theo tên/điện thoại">
            <div id="c_list" class="mt-3"></div>
          </div>
        </div>
      </section>

      <!-- CSKH -->
      <section id="section-cskh" class="hidden">
        <div class="grid-2">
          <div class="card p-3">
            <h5 class="mb-3">Mục CSKH</h5>
            <div class="row g-2">
              <div class="col-md-4"><input id="care_ngay" class="form-control" placeholder="Ngày CSKH (dd/MM/yyyy)"></div>
              <div class="col-md-4"><input id="care_customer_id" class="form-control" placeholder="customer_id"></div>
              <div class="col-md-4"><select id="care_kenh" class="form-select"><option>Gọi điện</option><option>Nhắn tin</option><option>Gọi điện + Nhắn tin</option></select></div>
            </div>
            <div class="row g-2 mt-2">
              <div class="col-md-6"><input id="care_nv" class="form-control" placeholder="Nhân viên"></div>
              <div class="col-md-6"><input id="care_noi_dung" class="form-control" placeholder="Nội dung CSKH"></div>
            </div>
            <div class="row g-2 mt-2">
              <div class="col-md-6"><input id="care_phan_hoi" class="form-control" placeholder="Phản hồi khách (VD: từ chối / tham khảo / hẹn lên / đã mua hãng khác / không nghe)"></div>
              <div class="col-md-6"><input id="care_note" class="form-control" placeholder="Ghi chú"></div>
            </div>
            <div class="mt-2">
              <label class="me-2">Trạng thái tiềm năng (1 lựa chọn):</label>
              <div class="form-check form-check-inline"><input class="form-check-input" type="radio" name="care_flag" id="f1"><label class="form-check-label" for="f1">còn tiềm năng</label></div>
              <div class="form-check form-check-inline"><input class="form-check-input" type="radio" name="care_flag" id="f2"><label class="form-check-label" for="f2">hết tiềm năng</label></div>
              <div class="form-check form-check-inline"><input class="form-check-input" type="radio" name="care_flag" id="f3"><label class="form-check-label" for="f3">đang nuôi khách</label></div>
              <div class="form-check form-check-inline"><input class="form-check-input" type="radio" name="care_flag" id="f4"><label class="form-check-label" for="f4">đang hẹn lên</label></div>
            </div>
            <button class="btn btn-klc mt-2" id="btnSaveCSKH">Lưu CSKH</button>
          </div>
          <div class="card p-3">
            <h5 class="mb-3">Khách đã CSKH gần đây</h5>
            <input id="care_search" class="form-control mb-2" placeholder="Tìm theo tên/điện thoại">
            <div id="care_recent"></div>
          </div>
        </div>
      </section>

      <!-- The rest sections can keep original implementation on your side -->

      <section id="section-admin" class="hidden"><div class="card p-3">Chỉ admin mới thấy mục này.</div></section>
    </div> <!-- /#app -->
  </div> <!-- /.container -->

  <!-- Overlay + Toast -->
  <div class="loading-overlay" id="globalLoading"><div class="spinner-border text-primary" role="status"></div></div>
  <div id="toastWrap"></div>

  <script src="./assets/js/app.js"></script>
</body>
</html>
